{"version":3,"sources":["kdlyticsgui/wealth.cljs"],"mappings":"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","names":["kdlyticsgui.wealth/halfrw","kdlyticsgui.wealth/maxrw","kdlyticsgui.wealth/summary-display","re-frame.core/dispatch","cljs.core/deref","data","re_frame.core.subscribe","columns","kdlyticsgui.mrttables.text_col","kdlyticsgui.mrttables.nb_col","kdlyticsgui.mrttables/round0","kdlyticsgui.mrttables/round1","kdlyticsgui.mrttables/round2pc100","cljs.core.assoc","kdlyticsgui.mrttables/allocation-delta-formatting","helix.core/get-react","obj46684","kdlyticsgui.mrttables/nb-thousand-cell-format","kdlyticsgui.mrttables/round1pc","kdlyticsgui.mrttables/round2","kdlyticsgui.mrttables/round2pc","kdlyticsgui.guitools/mrt-right-element-box-generic","kdlyticsgui.mrttables/material-react-table-template-fast","kdlyticsgui.mrttables/full-row-formatting","kdlyticsgui.mrttables/mrt-table-toolbar","kdlyticsgui.mrttables/mrt-default-download-fn","kdlyticsgui.wealth/projection-display","re-com.core/box","kdlyticsgui.guitools.element_box"],"sourcesContent":["(ns kdlyticsgui.wealth\r\n  (:require [kdlyticsgui.guitools :as gt]\r\n            [re-frame.core :as rf]\r\n            [re-com.core :refer [p p-span h-box v-box box gap line scroller border label title button close-button checkbox hyperlink-href slider horizontal-bar-tabs radio-button info-button\r\n                                 single-dropdown hyperlink modal-panel alert-box throbber input-password selection-list md-circle-icon-button\r\n                                 input-text input-textarea popover-anchor-wrapper popover-content-wrapper popover-tooltip datepicker-dropdown] :refer-macros [handler-fn]]\r\n            [kdlyticsgui.mrttables :as mrt]\r\n            [helix.core :refer [defnc $]]\r\n            )\r\n  )\r\n\r\n(def halfrw \"850px\")\r\n(def maxrw \"1790px\")\r\n\r\n(defn summary-display []\r\n  (rf/dispatch [:get-positions-summary])\r\n  (let [data @(rf/subscribe [:positions-summary])\r\n        columns [{:header \"Description\" :id \"description\" :columns [(mrt/text-col \"Ticker\" \"ticker\" 60)\r\n                                                                    (mrt/text-col \"Cat.\" \"asset-class\" 60)\r\n                                                                    (mrt/text-col \"Acc.\" \"account\" 60)\r\n                                                                    (mrt/text-col \"CCY\" \"currency\" 60)\r\n                                                                    (mrt/text-col \"Name\" \"shortName\" 200)]}\r\n                 {:header \"Position & PnL\" :id \"position\" :columns [(mrt/nb-col \"Qt\" \"quantity\" 50 mrt/round0)\r\n                                                                    (mrt/nb-col \"CPU\" \"cost-per-unit\" 50 mrt/round1)\r\n                                                                    (mrt/nb-col \"Price\" \"regularMarketPrice\" 50 mrt/round1)\r\n\r\n                                                                    (mrt/nb-col \"Nav lcl\" \"nav-local\" 50 mrt/round0)\r\n                                                                    (mrt/nb-col \"Nav \u20ac\" \"nav-eur\" 50 mrt/round0)\r\n                                                                    (mrt/nb-col \"Nav \u20ac %\" \"nav-eur-perc\" 50 mrt/round2pc100) ;formating >5%\r\n\r\n                                                                    (mrt/nb-col \"Pnl lcl\" \"pnl-local\" 50 mrt/round0)\r\n                                                                    (mrt/nb-col \"Pnl \u20ac\" \"pnl-eur\" 50 mrt/round0)\r\n                                                                    (mrt/nb-col \"Pnl \u20ac %\" \"pnl-eur-perc\" 50 mrt/round2pc100)\r\n\r\n                                                                    ]}\r\n                 {:header \"Allocation\" :id \"allocation\" :columns [(mrt/text-col \"#\" \"nb-strategies\" 50)\r\n                                                                  (mrt/text-col \"Strategy 1\" \"strategy-1\" 50)\r\n                                                                  (mrt/text-col \"Strategy 2\" \"strategy-2\" 50)\r\n                                                                  (mrt/text-col \"Strategy 3\" \"strategy-3\" 50)\r\n\r\n                                                                  (mrt/nb-col \"Alloc. 1\" \"alloc-strat-1\" 50 mrt/round0)\r\n                                                                  (mrt/nb-col \"Alloc. 2\" \"alloc-strat-2\" 50 mrt/round0)\r\n                                                                  (mrt/nb-col \"Alloc. 3\" \"alloc-strat-3\" 50 mrt/round0)\r\n\r\n                                                                  (mrt/nb-col \"Total\" \"alloc-strat-total\" 50 mrt/round0)\r\n                                                                  ;(mrt/nb-col \"Delta\" \"alloc-strat-delta\" 50 mrt/round0) ;if >500 green ?, if below -500 red ? allocation-delta-formatting\r\n                                                                  (assoc (mrt/nb-col \"Delta\" \"alloc-strat-delta\" 50 mrt/round0) :muiTableBodyCellProps mrt/allocation-delta-formatting)\r\n\r\n                                                                    ]}\r\n                 {:header \"Quant metrics\" :id \"quant\" :columns [(mrt/nb-col \"Mkt Cap $mil\" \"marketCap\" 50 mrt/nb-thousand-cell-format)\r\n                                                                (mrt/nb-col \"Margin\" \"profitMargin\" 50 mrt/round0)\r\n                                                                (mrt/nb-col \"TrailEPS\" \"trailingEps\" 50 mrt/round0)\r\n                                                                (mrt/nb-col \"FwdEPS\" \"forwardEps\" 50 mrt/round0)\r\n\r\n                                                                (mrt/nb-col \"YTD\" \"ytdReturn\" 50 mrt/round1pc)\r\n                                                                (mrt/nb-col \"1Y\" \"52WeekChange\" 50 mrt/round1pc)\r\n                                                                (mrt/nb-col \"High1Y\" \"fiftyTwoWeekHigh\" 50 mrt/round1)\r\n                                                                (mrt/nb-col \"Low1Y\" \"fiftyTwoWeekLow\" 50 mrt/round1)\r\n                                                                (mrt/nb-col \"Beta\" \"beta\" 50 mrt/round1)\r\n\r\n                                                                (mrt/nb-col \"PE\" \"trailingPE\" 50 mrt/round1)\r\n                                                                (mrt/nb-col \"FwdPE\" \"forwardPE\" 50 mrt/round1)\r\n                                                                (mrt/nb-col \"PB\" \"priceToBook\" 50 mrt/round0)\r\n                                                                (mrt/nb-col \"EV/EB\" \"enterpriseToEbitda\" 100 mrt/round2)\r\n                                                                (mrt/nb-col \"BV\" \"bookValue\" 50 mrt/round0)\r\n\r\n                                                                (mrt/nb-col \"Div last\" \"lastDividendValue\" 50 mrt/round2)\r\n                                                                (mrt/nb-col \"Div %\" \"dividendYield\" 50 mrt/round2pc100)\r\n                                                                (mrt/nb-col \"Div % 5Y\" \"fiveYearAvgDividendYield\" 50 mrt/round2pc)\r\n                                                                (mrt/nb-col \"Payout\" \"payoutRatio\" 50 mrt/round2pc100)\r\n                                                                ]}\r\n                 ]\r\n        ]\r\n    ;(println (sort (keys (first data))))\r\n    [gt/mrt-right-element-box-generic \"wealth-summary\" maxrw \"W summary\" {}\r\n     [($ mrt/material-react-table-template-fast\r\n         {:clj-data data\r\n          :clj-columns columns\r\n          :clj-option-map   {:enableGrouping false :enablePinning true :enablePagination false :muiTableBodyRowProps mrt/full-row-formatting :muiTableBodyProps nil}  ;to avoid the cell formatting to mess up this the row formatting :muiTableBodyRowProps, we set the :muiTableBodyProps to nil, cell format override row formating\r\n          ;TODO go-to-attribution-risk\r\n          :js-initial-state #js {\"density\" \"compact\"\r\n                                 \"showColumnFilters\" true\r\n                                 \"pagination\" #js {\"pageSize\" 50}\r\n                                 \"grouping\" #js []\r\n                                 \"sorting\" #js [ #js{\"id\" \"nav-eur-perc\" \"desc\" true}]\r\n                                 \"columnVisibility\" #js {\"nav-local\" false \"pnl-local\" false \"strategy-3\" false \"alloc-strat-1\" false \"alloc-strat-2\" false \"alloc-strat-3\" false}}\r\n          :toolbar          mrt/mrt-table-toolbar\r\n          :download-fn      (mrt/mrt-default-download-fn \"wealth-summary\" columns)\r\n          :photo-id         \"wealth-summary\"})\r\n      ]]\r\n\r\n    ;[box :class \"element\" :child\r\n    ; [gt/mrt-right-element-box-generic \"esg-data\" \"1790px\" \"ESG data\" {}]]\r\n\r\n    ))\r\n\r\n\r\n(defn projection-display []\r\n  (let [data nil]                                              ;@(rf/subscribe [:summary-display/table])\r\n    [box :class \"subbody rightelement\" :child\r\n     (gt/element-box \"summary\" \"100%\" (str \"Projection \") data\r\n                     []\r\n                     ;[[:> ReactTable\r\n                     ;  {:data           data\r\n                     ;   :columns        [{:Header \"Portfolio\" :accessor \"portfolio\" :width 90 :filterable true :filterMethod tables/text-filter-OR :Cell #((if rot13? t/rot13 identity) (gobj/get % \"value\"))}\r\n                     ;                    {:Header \"Balance\" :columns (mapv #(assoc % :filterable false) (mapv tables/risk-table-columns [:value :cash-pct]))}\r\n                     ;\r\n                     ;                    ]\r\n                     ;   :showPagination false :pageSize (count @(rf/subscribe [:portfolios])) :getTrProps go-to-portfolio-risk :className \"-striped -highlight\"}]\r\n                     ; ]\r\n                     )\r\n     ]\r\n    ))"]}