{"version":3,"sources":["jasminegui/administration.cljs"],"mappings":"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","names":["re_frame.core.reg_event_fx.cljs$core$IFn$_invoke$arity$2","p__44036","p__44037","map__44038","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","vec__44043","cljs.core.nth.cljs$core$IFn$_invoke$arity$3","db","_","cljs.core.assoc.cljs$core$IFn$_invoke$arity$3","jasminegui.mount/server-address","re_frame.core.reg_event_db.cljs$core$IFn$_invoke$arity$2","p__44048","vec__44049","data","G__44052","re-frame.core/dispatch","G__44053","G__44054","G__44055","G__44056","G__44057","G__44058","G__44059","G__44061","cljs.core/assoc-in","p__44062","vec__44063","jasminegui.administration/modal-success","cljs.core/deref","modal-data","G__44066","re-frame.core/subscribe","re-com.core/modal-panel","G__44067","re-com.core/alert-box","temp__5733__auto__","x","re-com.core/box","re-com.core/throbber","G__44069","jasminegui.administration/debug-operations","re-com.core/v-box","re-com.core/title","re-com.core/h-box","re-com.core/label","re-com.core/button","G__44071","jasminegui.administration/administration-view"],"sourcesContent":["(ns jasminegui.administration\r\n  (:require\r\n    ; [oz.core :as oz]\r\n    [re-frame.core :as rf]\r\n    [reagent.core :as r]\r\n    [goog.string :as gstring]\r\n    [goog.string.format]\r\n    [re-com.core :refer [p p-span h-box v-box box gap line scroller border label title button close-button checkbox hyperlink-href slider horizontal-bar-tabs radio-button info-button\r\n                         single-dropdown hyperlink modal-panel alert-box throbber input-password selection-list md-circle-icon-button\r\n                         input-text input-textarea popover-anchor-wrapper popover-content-wrapper popover-tooltip datepicker-dropdown] :refer-macros [handler-fn]]\r\n    [re-com.box :refer [h-box-args-desc v-box-args-desc box-args-desc gap-args-desc line-args-desc scroller-args-desc border-args-desc flex-child-style]]\r\n    [re-com.util :refer [px]]\r\n    [jasminegui.mount :as mount]\r\n    [jasminegui.static :as static]\r\n\r\n    [re-com.validate :refer [string-or-hiccup? alert-type? vector-of-maps?]])\r\n  )\r\n\r\n(rf/reg-event-fx\r\n  :rebuild\r\n  (fn [{:keys [db]} [_]]\r\n    {:db (assoc db :success-modal {:show true :on-close :close-rebuild :response nil})\r\n     :http-post-dispatch {:url          (str mount/server-address \"rebuild\")\r\n                          :edn-params   {}\r\n                          :dispatch-key [:has-rebuilt]\r\n                          :kwk          true}}))\r\n\r\n(rf/reg-event-db\r\n  :has-rebuilt\r\n  (fn [db [_ data]]\r\n    (rf/dispatch [:get-portfolios])\r\n    (rf/dispatch [:get-positions])\r\n    (rf/dispatch [:get-pivoted-positions])\r\n    (rf/dispatch [:get-total-positions])\r\n    (rf/dispatch [:get-rating-to-score])\r\n    (rf/dispatch [:get-qt-date])\r\n    (rf/dispatch [:get-var-proxies])\r\n    (rf/dispatch [:get-var-dates])\r\n    (rf/dispatch [:get-portfolio-var \"OGEMCORD\"])\r\n    (assoc-in db [:success-modal :response] (:text-response data))))\r\n\r\n(rf/reg-event-db\r\n  :close-rebuild\r\n  (fn [db [_]]\r\n    (assoc db :success-modal {:show false :on-close nil :response nil})))\r\n\r\n(defn modal-success []\r\n  (let [modal-data @(rf/subscribe [:success-modal])]\r\n    (if (:show modal-data)\r\n      [modal-panel\r\n       :wrap-nicely? false\r\n       :backdrop-on-click #(rf/dispatch [(:on-close modal-data)])\r\n       :child [alert-box\r\n               :padding \"15px\"\r\n               :style {:width \"450px\"}\r\n               :heading (if-let [x (:response modal-data)] x [box :align :center :child [throbber :size :large]])\r\n               :closeable? true\r\n               :on-close #(rf/dispatch [(:on-close modal-data)])]])))\r\n\r\n\r\n(defn debug-operations []\r\n   [v-box\r\n    :gap \"10px\"\r\n    :width \"400px\"\r\n    :class \"subbody element\"\r\n    :children [[title :label \"Debug operations\" :level :level1]\r\n               [h-box  :gap \"10px\" :align :center\r\n                :children [[box  :size \"1\" :child [label :label \"Rebuild positions and VaR:\"]]\r\n                           [box  :size \"1\" :child [button :style {:width \"100%\"} :label \"Do it!\" :on-click #(rf/dispatch [:rebuild])]]]]\r\n               ]]\r\n  )\r\n\r\n(defn administration-view []\r\n  [v-box                                                  ;:gap \"10px\"\r\n   :gap \"10px\"\r\n   :padding \"80px 25px\"\r\n   :children [[modal-success] [debug-operations]]]\r\n  )\r\n"]}