{
"version":3,
"file":"module$node_modules$vega_runtime$build$vega_runtime.js",
"lineCount":23,
"mappings":"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",
"sources":["node_modules/vega-runtime/build/vega-runtime.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$vega_runtime$build$vega_runtime\"] = function(global,require,module,exports) {\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('vega-util'), require('vega-dataflow')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'vega-util', 'vega-dataflow'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.vega = {}, global.vega, global.vega));\n})(this, (function (exports, vegaUtil, vegaDataflow) { 'use strict';\n\n  /**\n   * Parse a serialized dataflow specification.\n   */\n  function parse (spec) {\n    const ctx = this,\n      operators = spec.operators || [];\n\n    // parse background\n    if (spec.background) {\n      ctx.background = spec.background;\n    }\n\n    // parse event configuration\n    if (spec.eventConfig) {\n      ctx.eventConfig = spec.eventConfig;\n    }\n\n    // parse locale configuration\n    if (spec.locale) {\n      ctx.locale = spec.locale;\n    }\n\n    // parse operators\n    operators.forEach(entry => ctx.parseOperator(entry));\n\n    // parse operator parameters\n    operators.forEach(entry => ctx.parseOperatorParameters(entry));\n\n    // parse streams\n    (spec.streams || []).forEach(entry => ctx.parseStream(entry));\n\n    // parse updates\n    (spec.updates || []).forEach(entry => ctx.parseUpdate(entry));\n    return ctx.resolve();\n  }\n\n  const Skip = vegaUtil.toSet(['rule']),\n    Swap = vegaUtil.toSet(['group', 'image', 'rect']);\n  function adjustSpatial(encode, marktype) {\n    let code = '';\n    if (Skip[marktype]) return code;\n    if (encode.x2) {\n      if (encode.x) {\n        if (Swap[marktype]) {\n          code += 'if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;';\n        }\n        code += 'o.width=o.x2-o.x;';\n      } else {\n        code += 'o.x=o.x2-(o.width||0);';\n      }\n    }\n    if (encode.xc) {\n      code += 'o.x=o.xc-(o.width||0)/2;';\n    }\n    if (encode.y2) {\n      if (encode.y) {\n        if (Swap[marktype]) {\n          code += 'if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;';\n        }\n        code += 'o.height=o.y2-o.y;';\n      } else {\n        code += 'o.y=o.y2-(o.height||0);';\n      }\n    }\n    if (encode.yc) {\n      code += 'o.y=o.yc-(o.height||0)/2;';\n    }\n    return code;\n  }\n  function canonicalType(type) {\n    return (type + '').toLowerCase();\n  }\n  function isOperator(type) {\n    return canonicalType(type) === 'operator';\n  }\n  function isCollect(type) {\n    return canonicalType(type) === 'collect';\n  }\n\n  function expression(ctx, args, code) {\n    // wrap code in return statement if expression does not terminate\n    if (!code.endsWith(';')) {\n      code = 'return(' + code + ');';\n    }\n    const fn = Function(...args.concat(code));\n    return ctx && ctx.functions ? fn.bind(ctx.functions) : fn;\n  }\n\n  // generate code for comparing a single field\n  function _compare(u, v, lt, gt) {\n    return `((u = ${u}) < (v = ${v}) || u == null) && v != null ? ${lt}\n  : (u > v || v == null) && u != null ? ${gt}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${lt}\n  : v !== v && u === u ? ${gt} : `;\n  }\n  var expressionCodegen = {\n    /**\n     * Parse an expression used to update an operator value.\n     */\n    operator: (ctx, expr) => expression(ctx, ['_'], expr.code),\n    /**\n     * Parse an expression provided as an operator parameter value.\n     */\n    parameter: (ctx, expr) => expression(ctx, ['datum', '_'], expr.code),\n    /**\n     * Parse an expression applied to an event stream.\n     */\n    event: (ctx, expr) => expression(ctx, ['event'], expr.code),\n    /**\n     * Parse an expression used to handle an event-driven operator update.\n     */\n    handler: (ctx, expr) => {\n      const code = `var datum=event.item&&event.item.datum;return ${expr.code};`;\n      return expression(ctx, ['_', 'event'], code);\n    },\n    /**\n     * Parse an expression that performs visual encoding.\n     */\n    encode: (ctx, encode) => {\n      const {\n        marktype,\n        channels\n      } = encode;\n      let code = 'var o=item,datum=o.datum,m=0,$;';\n      for (const name in channels) {\n        const o = 'o[' + vegaUtil.stringValue(name) + ']';\n        code += `$=${channels[name].code};if(${o}!==$)${o}=$,m=1;`;\n      }\n      code += adjustSpatial(channels, marktype);\n      code += 'return m;';\n      return expression(ctx, ['item', '_'], code);\n    },\n    /**\n     * Optimized code generators for access and comparison.\n     */\n    codegen: {\n      get(path) {\n        const ref = `[${path.map(vegaUtil.stringValue).join('][')}]`;\n        const get = Function('_', `return _${ref};`);\n        get.path = ref;\n        return get;\n      },\n      comparator(fields, orders) {\n        let t;\n        const map = (f, i) => {\n          const o = orders[i];\n          let u, v;\n          if (f.path) {\n            u = `a${f.path}`;\n            v = `b${f.path}`;\n          } else {\n            (t = t || {})['f' + i] = f;\n            u = `this.f${i}(a)`;\n            v = `this.f${i}(b)`;\n          }\n          return _compare(u, v, -o, o);\n        };\n        const fn = Function('a', 'b', 'var u, v; return ' + fields.map(map).join('') + '0;');\n        return t ? fn.bind(t) : fn;\n      }\n    }\n  };\n\n  /**\n   * Parse a dataflow operator.\n   */\n  function parseOperator(spec) {\n    const ctx = this;\n    if (isOperator(spec.type) || !spec.type) {\n      ctx.operator(spec, spec.update ? ctx.operatorExpression(spec.update) : null);\n    } else {\n      ctx.transform(spec, spec.type);\n    }\n  }\n\n  /**\n   * Parse and assign operator parameters.\n   */\n  function parseOperatorParameters(spec) {\n    const ctx = this;\n    if (spec.params) {\n      const op = ctx.get(spec.id);\n      if (!op) vegaUtil.error('Invalid operator id: ' + spec.id);\n      ctx.dataflow.connect(op, op.parameters(ctx.parseParameters(spec.params), spec.react, spec.initonly));\n    }\n  }\n\n  /**\n   * Parse a set of operator parameters.\n   */\n  function parseParameters(spec, params) {\n    params = params || {};\n    const ctx = this;\n    for (const key in spec) {\n      const value = spec[key];\n      params[key] = vegaUtil.isArray(value) ? value.map(v => parseParameter(v, ctx, params)) : parseParameter(value, ctx, params);\n    }\n    return params;\n  }\n\n  /**\n   * Parse a single parameter.\n   */\n  function parseParameter(spec, ctx, params) {\n    if (!spec || !vegaUtil.isObject(spec)) return spec;\n    for (let i = 0, n = PARSERS.length, p; i < n; ++i) {\n      p = PARSERS[i];\n      if (vegaUtil.hasOwnProperty(spec, p.key)) {\n        return p.parse(spec, ctx, params);\n      }\n    }\n    return spec;\n  }\n\n  /** Reference parsers. */\n  var PARSERS = [{\n    key: '$ref',\n    parse: getOperator\n  }, {\n    key: '$key',\n    parse: getKey\n  }, {\n    key: '$expr',\n    parse: getExpression\n  }, {\n    key: '$field',\n    parse: getField\n  }, {\n    key: '$encode',\n    parse: getEncode\n  }, {\n    key: '$compare',\n    parse: getCompare\n  }, {\n    key: '$context',\n    parse: getContext\n  }, {\n    key: '$subflow',\n    parse: getSubflow\n  }, {\n    key: '$tupleid',\n    parse: getTupleId\n  }];\n\n  /**\n   * Resolve an operator reference.\n   */\n  function getOperator(_, ctx) {\n    return ctx.get(_.$ref) || vegaUtil.error('Operator not defined: ' + _.$ref);\n  }\n\n  /**\n   * Resolve an expression reference.\n   */\n  function getExpression(_, ctx, params) {\n    if (_.$params) {\n      // parse expression parameters\n      ctx.parseParameters(_.$params, params);\n    }\n    const k = 'e:' + _.$expr.code;\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.accessor(ctx.parameterExpression(_.$expr), _.$fields));\n  }\n\n  /**\n   * Resolve a key accessor reference.\n   */\n  function getKey(_, ctx) {\n    const k = 'k:' + _.$key + '_' + !!_.$flat;\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.key(_.$key, _.$flat, ctx.expr.codegen));\n  }\n\n  /**\n   * Resolve a field accessor reference.\n   */\n  function getField(_, ctx) {\n    if (!_.$field) return null;\n    const k = 'f:' + _.$field + '_' + _.$name;\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.field(_.$field, _.$name, ctx.expr.codegen));\n  }\n\n  /**\n   * Resolve a comparator function reference.\n   */\n  function getCompare(_, ctx) {\n    // As of Vega 5.5.3, $tupleid sort is no longer used.\n    // Keep here for now for backwards compatibility.\n    const k = 'c:' + _.$compare + '_' + _.$order,\n      c = vegaUtil.array(_.$compare).map(_ => _ && _.$tupleid ? vegaDataflow.tupleid : _);\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.compare(c, _.$order, ctx.expr.codegen));\n  }\n\n  /**\n   * Resolve an encode operator reference.\n   */\n  function getEncode(_, ctx) {\n    const spec = _.$encode,\n      encode = {};\n    for (const name in spec) {\n      const enc = spec[name];\n      encode[name] = vegaUtil.accessor(ctx.encodeExpression(enc.$expr), enc.$fields);\n      encode[name].output = enc.$output;\n    }\n    return encode;\n  }\n\n  /**\n   * Resolve a context reference.\n   */\n  function getContext(_, ctx) {\n    return ctx;\n  }\n\n  /**\n   * Resolve a recursive subflow specification.\n   */\n  function getSubflow(_, ctx) {\n    const spec = _.$subflow;\n    return function (dataflow, key, parent) {\n      const subctx = ctx.fork().parse(spec),\n        op = subctx.get(spec.operators[0].id),\n        p = subctx.signals.parent;\n      if (p) p.set(parent);\n      op.detachSubflow = () => ctx.detach(subctx);\n      return op;\n    };\n  }\n\n  /**\n   * Resolve a tuple id reference.\n   */\n  function getTupleId() {\n    return vegaDataflow.tupleid;\n  }\n\n  /**\n   * Parse an event stream specification.\n   */\n  function parseStream (spec) {\n    var ctx = this,\n      filter = spec.filter != null ? ctx.eventExpression(spec.filter) : undefined,\n      stream = spec.stream != null ? ctx.get(spec.stream) : undefined,\n      args;\n    if (spec.source) {\n      stream = ctx.events(spec.source, spec.type, filter);\n    } else if (spec.merge) {\n      args = spec.merge.map(_ => ctx.get(_));\n      stream = args[0].merge.apply(args[0], args.slice(1));\n    }\n    if (spec.between) {\n      args = spec.between.map(_ => ctx.get(_));\n      stream = stream.between(args[0], args[1]);\n    }\n    if (spec.filter) {\n      stream = stream.filter(filter);\n    }\n    if (spec.throttle != null) {\n      stream = stream.throttle(+spec.throttle);\n    }\n    if (spec.debounce != null) {\n      stream = stream.debounce(+spec.debounce);\n    }\n    if (stream == null) {\n      vegaUtil.error('Invalid stream definition: ' + JSON.stringify(spec));\n    }\n    if (spec.consume) stream.consume(true);\n    ctx.stream(spec, stream);\n  }\n\n  /**\n   * Parse an event-driven operator update.\n   */\n  function parseUpdate (spec) {\n    var ctx = this,\n      srcid = vegaUtil.isObject(srcid = spec.source) ? srcid.$ref : srcid,\n      source = ctx.get(srcid),\n      target = null,\n      update = spec.update,\n      params = undefined;\n    if (!source) vegaUtil.error('Source not defined: ' + spec.source);\n    target = spec.target && spec.target.$expr ? ctx.eventExpression(spec.target.$expr) : ctx.get(spec.target);\n    if (update && update.$expr) {\n      if (update.$params) {\n        params = ctx.parseParameters(update.$params);\n      }\n      update = ctx.handlerExpression(update.$expr);\n    }\n    ctx.update(spec, source, target, update, params);\n  }\n\n  const SKIP = {\n    skip: true\n  };\n  function getState(options) {\n    var ctx = this,\n      state = {};\n    if (options.signals) {\n      var signals = state.signals = {};\n      Object.keys(ctx.signals).forEach(key => {\n        const op = ctx.signals[key];\n        if (options.signals(key, op)) {\n          signals[key] = op.value;\n        }\n      });\n    }\n    if (options.data) {\n      var data = state.data = {};\n      Object.keys(ctx.data).forEach(key => {\n        const dataset = ctx.data[key];\n        if (options.data(key, dataset)) {\n          data[key] = dataset.input.value;\n        }\n      });\n    }\n    if (ctx.subcontext && options.recurse !== false) {\n      state.subcontext = ctx.subcontext.map(ctx => ctx.getState(options));\n    }\n    return state;\n  }\n  function setState(state) {\n    var ctx = this,\n      df = ctx.dataflow,\n      data = state.data,\n      signals = state.signals;\n    Object.keys(signals || {}).forEach(key => {\n      df.update(ctx.signals[key], signals[key], SKIP);\n    });\n    Object.keys(data || {}).forEach(key => {\n      df.pulse(ctx.data[key].input, df.changeset().remove(vegaUtil.truthy).insert(data[key]));\n    });\n    (state.subcontext || []).forEach((substate, i) => {\n      const subctx = ctx.subcontext[i];\n      if (subctx) subctx.setState(substate);\n    });\n  }\n\n  /**\n   * Context objects store the current parse state.\n   * Enables lookup of parsed operators, event streams, accessors, etc.\n   * Provides a 'fork' method for creating child contexts for subflows.\n   */\n  function context (df, transforms, functions, expr) {\n    return new Context(df, transforms, functions, expr);\n  }\n  function Context(df, transforms, functions, expr) {\n    this.dataflow = df;\n    this.transforms = transforms;\n    this.events = df.events.bind(df);\n    this.expr = expr || expressionCodegen, this.signals = {};\n    this.scales = {};\n    this.nodes = {};\n    this.data = {};\n    this.fn = {};\n    if (functions) {\n      this.functions = Object.create(functions);\n      this.functions.context = this;\n    }\n  }\n  function Subcontext(ctx) {\n    this.dataflow = ctx.dataflow;\n    this.transforms = ctx.transforms;\n    this.events = ctx.events;\n    this.expr = ctx.expr;\n    this.signals = Object.create(ctx.signals);\n    this.scales = Object.create(ctx.scales);\n    this.nodes = Object.create(ctx.nodes);\n    this.data = Object.create(ctx.data);\n    this.fn = Object.create(ctx.fn);\n    if (ctx.functions) {\n      this.functions = Object.create(ctx.functions);\n      this.functions.context = this;\n    }\n  }\n  Context.prototype = Subcontext.prototype = {\n    fork() {\n      const ctx = new Subcontext(this);\n      (this.subcontext || (this.subcontext = [])).push(ctx);\n      return ctx;\n    },\n    detach(ctx) {\n      this.subcontext = this.subcontext.filter(c => c !== ctx);\n\n      // disconnect all nodes in the subcontext\n      // wipe out targets first for better efficiency\n      const keys = Object.keys(ctx.nodes);\n      for (const key of keys) ctx.nodes[key]._targets = null;\n      for (const key of keys) ctx.nodes[key].detach();\n      ctx.nodes = null;\n    },\n    get(id) {\n      return this.nodes[id];\n    },\n    set(id, node) {\n      return this.nodes[id] = node;\n    },\n    add(spec, op) {\n      const ctx = this,\n        df = ctx.dataflow,\n        data = spec.value;\n      ctx.set(spec.id, op);\n      if (isCollect(spec.type) && data) {\n        if (data.$ingest) {\n          df.ingest(op, data.$ingest, data.$format);\n        } else if (data.$request) {\n          df.preload(op, data.$request, data.$format);\n        } else {\n          df.pulse(op, df.changeset().insert(data));\n        }\n      }\n      if (spec.root) {\n        ctx.root = op;\n      }\n      if (spec.parent) {\n        let p = ctx.get(spec.parent.$ref);\n        if (p) {\n          df.connect(p, [op]);\n          op.targets().add(p);\n        } else {\n          (ctx.unresolved = ctx.unresolved || []).push(() => {\n            p = ctx.get(spec.parent.$ref);\n            df.connect(p, [op]);\n            op.targets().add(p);\n          });\n        }\n      }\n      if (spec.signal) {\n        ctx.signals[spec.signal] = op;\n      }\n      if (spec.scale) {\n        ctx.scales[spec.scale] = op;\n      }\n      if (spec.data) {\n        for (const name in spec.data) {\n          const data = ctx.data[name] || (ctx.data[name] = {});\n          spec.data[name].forEach(role => data[role] = op);\n        }\n      }\n    },\n    resolve() {\n      (this.unresolved || []).forEach(fn => fn());\n      delete this.unresolved;\n      return this;\n    },\n    operator(spec, update) {\n      this.add(spec, this.dataflow.add(spec.value, update));\n    },\n    transform(spec, type) {\n      this.add(spec, this.dataflow.add(this.transforms[canonicalType(type)]));\n    },\n    stream(spec, stream) {\n      this.set(spec.id, stream);\n    },\n    update(spec, stream, target, update, params) {\n      this.dataflow.on(stream, target, update, params, spec.options);\n    },\n    // expression parsing\n    operatorExpression(expr) {\n      return this.expr.operator(this, expr);\n    },\n    parameterExpression(expr) {\n      return this.expr.parameter(this, expr);\n    },\n    eventExpression(expr) {\n      return this.expr.event(this, expr);\n    },\n    handlerExpression(expr) {\n      return this.expr.handler(this, expr);\n    },\n    encodeExpression(encode) {\n      return this.expr.encode(this, encode);\n    },\n    // parse methods\n    parse,\n    parseOperator,\n    parseOperatorParameters,\n    parseParameters,\n    parseStream,\n    parseUpdate,\n    // state methods\n    getState,\n    setState\n  };\n\n  exports.context = context;\n\n}));\n\n};"],
"names":["shadow$provide","global","require","module","exports","factory","define","amd","globalThis","self","vega","vegaUtil","vegaDataflow","expression","ctx","args","code","endsWith","fn","Function","concat","functions","bind","parseParameter","spec","params","isObject","i","n","PARSERS","length","p","hasOwnProperty","key","parse","Context","df","transforms","expr","dataflow","events","expressionCodegen","signals","scales","nodes","data","Object","create","context","Subcontext","Skip","toSet","Swap","operator","parameter","event","handler","encode","marktype","channels","name","o","stringValue","x2","x","xc","y2","y","yc","codegen","get","path","ref","map","join","comparator","fields","orders","t","f","u","v","lt","getOperator","_","$ref","error","getKey","k","$key","$flat","getExpression","$params","parseParameters","$expr","accessor","parameterExpression","$fields","getField","$field","$name","field","getEncode","$encode","enc","encodeExpression","output","$output","getCompare","$compare","$order","c","array","$tupleid","tupleid","compare","getContext","getSubflow","$subflow","parent","subctx","fork","op","operators","id","set","detachSubflow","op.detachSubflow","detach","getTupleId","SKIP","skip","prototype","push","subcontext","filter","keys","_targets","node","add","value","toLowerCase","type","$ingest","ingest","$format","$request","preload","pulse","changeset","insert","root","connect","targets","unresolved","signal","scale","forEach","role","resolve","update","transform","stream","target","on","options","operatorExpression","eventExpression","handlerExpression","background","eventConfig","locale","entry","parseOperator","parseOperatorParameters","streams","parseStream","updates","parseUpdate","parameters","react","initonly","isArray","undefined","source","merge","apply","slice","between","throttle","debounce","JSON","stringify","consume","srcid","getState","state","dataset","input","recurse","setState","remove","truthy","substate"]
}
